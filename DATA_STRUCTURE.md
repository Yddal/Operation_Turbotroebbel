# Study Program Data Extraction & Database Preparation

## Overview

This project extracts study program information from website HTML files and structures it as pandas DataFrames, preparing the data for MySQL database storage without implementing the MySQL connections yet.

## Project Structure

### Generated Files

1. **`study_data_structure.json`** - Complete extracted data in JSON format
   - Study programs with all metadata
   - Courses with links and credits
   - Learning outcomes structure (prepared for population)

2. **`database_schema.sql`** - MySQL database schema
   - Tables: `study_programs`, `courses`, `learning_outcomes`
   - Primary keys, foreign keys, and indexes
   - UTF-8 encoding for Norwegian text

3. **`insert_statements.sql`** - Generated SQL INSERT statements
   - Parameterized queries ready for execution
   - Can be reviewed before running in MySQL

4. **`data_coverage_report.json`** - Data completeness analysis
   - Field coverage percentage
   - Which fields are populated vs. missing
   - Ready for database: True

## Source Data

Extracted from: **Administrativ koordinator** - Norwegian Higher Vocational Education Program

### Extracted Information

#### Study Program Data
- ✅ **Title**: Administrativ koordinator
- ✅ **Description**: Program overview
- ✅ **Credits**: Available (60 studiepoeng)
- ❌ **Language**: Not extracted (Norsk - in HTML)
- ❌ **Level**: Not extracted (Fagskolegrad - in HTML)
- ✅ **Why Choose This Study**: Full text
- ✅ **What You Learn**: Curriculum overview
- ✅ **Teaching Format**: Nettbasert deltid med fysiske samlinger
- ✅ **Mandatory Attendance**: Extracted (75% requirement)
- ❌ **Police Certificate**: Not applicable for this program
- ✅ **Career Opportunities**: Job roles and sectors
- ✅ **Contact Info**: vikenfs@afk.no
- ✅ **Study URL**: Link to program page

#### Course Data (6 Courses)
1. Organisasjonsforståelse - 10 studiepoeng
2. Kommunikasjon, inkludert digitale verktøy - 10 studiepoeng
3. Administrativ lederstøtte, inkludert økonomi og personalarbeid - 10 studiepoeng
4. Endring og utvikling - 10 studiepoeng
5. Kontordrift/praktisk lederstøtte - 10 studiepoeng
6. Hovedprosjekt (faglig fordypning) - 10 studiepoeng

**For each course:**
- ✅ Title
- ✅ Credits (10 studiepoeng)
- ✅ Course URL (studiekatalog.edutorium.no links)
- ❌ Study Level (None - to be fetched from course pages)
- ❌ Learning Outcomes (Structure prepared, content to be extracted from course pages)

## Data Coverage Statistics

| Metric | Value |
|--------|-------|
| Study Program Coverage | 64.3% |
| Course Coverage | 80.0% |
| Total Study Programs | 1 |
| Total Courses | 6 |
| Ready for Database | ✅ Yes |

### Missing/None Fields

**Study Programs:**
- `id` (auto-generated by database)
- `credits` (found in HTML but not extracted: 60)
- `language` (found in HTML but not extracted: Norsk)
- `level` (found in HTML but not extracted: Fagskolegrad)
- `police_certificate` (N/A for this program)

**Courses:**
- `study_level` (Available in course catalog links, not extracted in bulk)
- `learning_outcomes.knowledge` (Requires fetching individual course pages)
- `learning_outcomes.skills` (Requires fetching individual course pages)
- `learning_outcomes.competence` (Requires fetching individual course pages)

## Data Structure (JSON Format)

```json
{
  "study_programs": [
    {
      "id": null,
      "title": "Administrativ koordinator",
      "description": "...",
      "credits": null,
      "language": null,
      "level": null,
      "why_choose": "...",
      "what_learn": "...",
      "teaching_format": "Nettbasert deltid med fysiske samlinger",
      "mandatory_attendance": "...",
      "police_certificate": null,
      "career_opportunities": "...",
      "contact_info": "...",
      "study_url": "https://fagskolen-viken.no/studier/ledelse/administrativ-koordinator"
    }
  ],
  "courses": [
    {
      "title": "Organisasjonsforståelse",
      "credits": "10 studiepoeng",
      "url": "https://studiekatalog.edutorium.no/viken/nb/emne/02AL66A-EILADK/2025-host",
      "study_level": null,
      "learning_outcomes": {
        "knowledge": null,
        "skills": null,
        "competence": null
      }
    }
  ]
}
```

## Database Schema

### Tables

#### `study_programs`
- Stores main study program information
- 14 fields including title, description, credits, language, level, etc.
- Indexes on `title` and `level`

#### `courses`
- Stores individual courses/subjects within programs
- Foreign key relationship to `study_programs`
- 5 fields: title, credits, url, study_level, study_program_id

#### `learning_outcomes`
- Stores detailed learning outcomes for each course
- Foreign key relationship to `courses`
- 3 fields: knowledge, skills, competence

## Python Modules

### `main.py` - Data Extraction
- **Class: `StudyDataExtractor`**
  - `load_html()` - Parse HTML file
  - `extract_study_info()` - Extract program metadata
  - `extract_courses()` - Extract course information
  - `structure_for_database()` - Organize data for DB
  - `to_dataframes()` - Convert to pandas DataFrames
  - `to_json()` - Export to JSON file
  - `display_dataframes_summary()` - Show extracted data

**Usage:**
```python
extractor = StudyDataExtractor("Administrativ koordinator.html")
if extractor.load_html():
    study_df, courses_df = extractor.to_dataframes()
    extractor.to_json()
```

### `database_preparation.py` - Database Preparation
- **Class: `StudyProgram`** - Data class for programs
- **Class: `Course`** - Data class for courses
- **Class: `LearningOutcomes`** - Data class for learning outcomes
- **Class: `DatabasePreparation`**
  - `validate_study_program()` - Validate program data
  - `validate_course()` - Validate course data
  - `prepare_insert_statements()` - Generate SQL statements
  - `generate_sql_script()` - Create complete SQL script
- **Class: `DataStructureValidator`**
  - `check_data_coverage()` - Analyze field population

**Usage:**
```python
data = json.load(open('study_data_structure.json'))
coverage = DataStructureValidator.check_data_coverage(data)
sql_script = DatabasePreparation.generate_sql_script(data)
```

## How to Use

### 1. Extract Data from HTML
```bash
python main.py
```
Output: `study_data_structure.json`

### 2. Analyze Data Coverage
```bash
python database_preparation.py
```
Outputs:
- `data_coverage_report.json` - Coverage analysis
- `insert_statements.sql` - SQL statements

### 3. Review Generated Files
```bash
# View JSON structure
cat study_data_structure.json

# View database schema
cat database_schema.sql

# View coverage report
cat data_coverage_report.json
```

### 4. Prepare MySQL Database (Manual Step)
```bash
# Create database and tables
mysql -u user -p < database_schema.sql
```

### 5. Insert Data (Future Implementation)
```bash
# Execute generated INSERT statements
mysql -u user -p < insert_statements.sql
```

## Pandas DataFrames

### Study Programs DataFrame
```
     id                      title                          description    credits language    level    why_choose    what_learn    teaching_format    ...
0  None  Administrativ koordinator  Administrativ koordinator er utdanningen...    None     None      None       ...              ...           ...
```

### Courses DataFrame
```
                                            title         credits                                                 url    study_level                                   learning_outcomes
0                                 Organisasjonsforståelse  10 studiepoeng  https://studiekatalog.edutorium.no/...        None  {'knowledge': None, 'skills': None, 'competence': None}
1  Kommunikasjon, inkludert digitale verktøy  10 studiepoeng  https://studiekatalog.edutorium.no/...        None  {'knowledge': None, 'skills': None, 'competence': None}
...
```

## Notes for MySQL Implementation

1. **Data Types**
   - `LONGTEXT` for large text fields (descriptions, outcomes)
   - `VARCHAR` for shorter fields
   - UTF-8 encoding (`utf8mb4_unicode_ci`) for Norwegian characters

2. **Relationships**
   - Courses have `FOREIGN KEY` to study_programs
   - Learning outcomes have `FOREIGN KEY` to courses
   - ON DELETE CASCADE for referential integrity

3. **Timestamps**
   - All tables include `created_at` and `updated_at`
   - Automatic update on modification

4. **Indexes**
   - Title and level fields indexed for faster queries
   - Foreign key columns indexed automatically

## Future Enhancements

To complete the data set:

1. **Fetch missing HTML fields**
   - Language: "Norsk" 
   - Credits: 60
   - Level: "Fagskolegrad"

2. **Extract learning outcomes**
   - Visit each course URL (studiekatalog.edutorium.no)
   - Parse learning outcomes (Kunnskap, Ferdigheter, Kompetanse)

3. **Add police certificate info**
   - Check if required for programs that need it
   - Add to relevant programs

4. **Implement MySQL connection**
   - Create MySQLConnection class
   - Add insert functions
   - Add query/update functions
   - Implement connection pooling

## File Dependencies

```
main.py
  ├─ requires: Administrativ koordinator.html
  ├─ requires: BeautifulSoup4, pandas
  └─ outputs: study_data_structure.json

database_preparation.py
  ├─ requires: study_data_structure.json
  ├─ requires: dataclasses, json
  └─ outputs: 
      ├─ data_coverage_report.json
      └─ insert_statements.sql

database_schema.sql
  └─ ready for MySQL execution

insert_statements.sql
  └─ generated from study_data_structure.json
  └─ ready for MySQL execution
```

## Data Export Options

- ✅ **JSON**: Full structure with all fields
- ✅ **Pandas DataFrame**: For analysis and manipulation
- ✅ **SQL Insert Statements**: Parameterized for MySQL
- ✅ **CSV** (Future): Can be added if needed

---

**Status**: Data extraction and preparation complete. Ready for MySQL database implementation.

**Last Updated**: 2026-01-26
